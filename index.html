<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University of Eldoret - Student Registration Forms</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCQ4B3CdAJ4WoFu-bPlZQtLgdpHvkXTK0w",
            authDomain: "uoe-student-form.firebaseapp.com",
            projectId: "uoe-student-form",
            storageBucket: "uoe-student-form.firebasestorage.app",
            messagingSenderId: "1023597600972",
            appId: "1:1023597600972:web:4a79cca07365059d392269",
            measurementId: "G-HS1FV2ZS80"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        window.analytics = getAnalytics(app);
        
        console.log('✅ Firebase initialized successfully');
    </script>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <!-- Progress Indicator -->
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-step active" id="step1">
                <div class="step-number">1</div>
                <div class="step-title">Personal Details</div>
            </div>
            <div class="progress-line" id="progressLine"></div>
            <div class="progress-step" id="step2">
                <div class="step-number">2</div>
                <div class="step-title">Media Consent</div>
            </div>
        </div>
    </div>

    <!-- Form Container -->
    <div class="form-wrapper">
        <!-- Student Personal Details Form -->
        <div class="form-section active" id="studentFormSection">
            <div class="container">
                <!-- Header Section -->
                <div class="header">
                    <div class="header-content">
                        <div class="university-logo">
                            <img src="logo.png" alt="University of Eldoret Logo" width="100" height="100" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 100 100\'%3E%3Ccircle cx=\'50\' cy=\'50\' r=\'45\' fill=\'%232a5298\'/%3E%3Ctext x=\'50\' y=\'55\' text-anchor=\'middle\' fill=\'white\' font-size=\'16\' font-weight=\'bold\'%3EUoE%3C/text%3E%3C/svg%3E'">
                        </div>
                        
                        <div class="header-center">
                            <h1>University of Eldoret</h1>
                            <p class="tagline">Excellence in Innovation and Development</p>
                            <div class="office-details">
                                <p><strong>OFFICE OF DEPUTY VICE-CHANCELLOR (ASA)</strong></p>
                                <p><strong>REGISTRAR ACADEMIC</strong></p>
                            </div>
                        </div>
                        
                        <div class="contact-info">
                            <p><strong>UoE/42</strong></p>
                            <p>P.O Box 1125 - 30100, Eldoret, Kenya Tel:</p>
                            <p>+254 53 2063257 / 2033213-15 Ext: 2525</p>
                            <p>Mobile: +254 711 631 524 +254 734 316 139</p>
                            <p>Email: registrar.academic@uoeld.ac.ke</p>
                            <p>Website: www.uoeld.ac.ke</p>
                        </div>
                    </div>
                    
                    <div class="photo-box">
                        <p>Affix your<br>Passport size<br>Photo here</p>
                    </div>
                </div>

                <!-- Form Content -->
                <div class="form-content">
                    <h2 class="form-title">STUDENT'S PERSONAL DETAILS</h2>
                    
                    <div class="instruction-text">
                        Information provided in this Form is intended to help the office of the Registrar Academic understand the student better. It will be used for purposes of improving the student's welfare while at the University. (To be completed in quadruple (4 copies) and in capital letters. <strong>Attach a coloured passport size photograph taken on a yellow background on each form.</strong>
                    </div>

                    <form id="studentForm">
                        <!-- Personal Information Fields -->
                        <div class="form-field">
                            <span class="field-number">1.</span>
                            <span class="field-label">Full Name:</span>
                            <input type="text" class="field-input name-input" id="fullName" required>
                            <div class="name-labels">
                                <span class="sub-label">(Surname or last Name)</span>
                                <span class="sub-label">(Other Names)</span>
                            </div>
                        </div>

                        <div class="two-column">
                            <div class="form-field">
                                <span class="field-number">2.</span>
                                <span class="field-label">University Admission Number</span>
                                <input type="text" class="field-input" id="admissionNumber" required>
                            </div>
                            <div class="form-field">
                                <span class="field-label">Phone No.</span>
                                <input type="tel" class="field-input" id="phoneNumber" required>
                            </div>
                        </div>

                        <div class="form-field triple-field">
                            <span class="field-number">3.</span>
                            <div class="field-group">
                                <span class="field-label">National ID No.</span>
                                <input type="text" class="field-input" id="nationalId" required>
                            </div>
                            <div class="field-group">
                                <span class="field-label">Passport No.</span>
                                <input type="text" class="field-input" id="passportNo">
                            </div>
                            <div class="field-group">
                                <span class="field-label">or Birth Certificate No. if under 18 years</span>
                                <input type="text" class="field-input" id="birthCertNo">
                            </div>
                        </div>

                        <div class="form-field triple-field">
                            <span class="field-number">4.</span>
                            <div class="field-group">
                                <span class="field-label">Religion</span>
                                <input type="text" class="field-input" id="religion">
                            </div>
                            <div class="field-group">
                                <span class="field-label">Nationality</span>
                                <input type="text" class="field-input" id="nationality" required>
                            </div>
                            <div class="field-group">
                                <span class="field-label">Gender</span>
                                <select class="field-input" id="gender" required>
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-field">
                            <span class="field-number">5.</span>
                            <span class="field-label">Ethnic Background</span>
                            <input type="text" class="field-input" id="ethnicBackground">
                        </div>

                        <div class="two-column">
                            <div class="form-field">
                                <span class="field-number">6.</span>
                                <span class="field-label">Date of Birth</span>
                                <input type="date" class="field-input" id="dateOfBirth" required>
                            </div>
                            <div class="form-field">
                                <span class="field-label">Place of Birth:</span>
                                <input type="text" class="field-input" id="placeOfBirth" required>
                            </div>
                        </div>

                        <div class="form-field">
                            <span class="field-number">7.</span>
                            <span class="field-label">Place of Permanent Residence: Village/Town</span>
                            <input type="text" class="field-input" id="permanentResidence" required>
                        </div>

                        <!-- Updated Location Section -->
                        <div class="form-field">
                            <span class="field-number">8.</span>
                            <span class="field-label">Location Details</span>
                        </div>
                        
                        <div class="form-field four-column" style="margin-left: 25px;">
                            <div class="field-group">
                                <span class="field-label">Location</span>
                                <input type="text" class="field-input" id="location" required>
                            </div>
                            <div class="field-group">
                                <span class="field-label">Name of Chief</span>
                                <input type="text" class="field-input" id="chiefName">
                            </div>
                            <div class="field-group">
                                <span class="field-label">Nearest Town</span>
                                <input type="text" class="field-input" id="nearestTown">
                            </div>
                            <div class="field-group">
                                <span class="field-label">Nearest Police Station</span>
                                <input type="text" class="field-input" id="nearestPolice">
                            </div>
                        </div>

                        <!-- Administrative Location Fields -->
                        <div class="form-field">
                            <span class="field-number">9.</span>
                            <span class="field-label">Administrative Location (Select in order):</span>
                        </div>
                        
                        <div class="form-field triple-field" style="margin-left: 25px;">
                            <div class="field-group location-field-group">
                                <span class="field-label">County</span>
                                <select class="location-dropdown" id="county" required>
                                    <option value="">Loading counties...</option>
                                </select>
                                <span class="location-help-text">Select your county first</span>
                            </div>
                            <div class="field-group location-field-group">
                                <span class="field-label">Sub County</span>
                                <select class="location-dropdown" id="subCounty" disabled required>
                                    <option value="">Select county first</option>
                                </select>
                                <span class="location-help-text">Will populate after county selection</span>
                            </div>
                            <div class="field-group location-field-group">
                                <span class="field-label">Constituency</span>
                                <select class="location-dropdown" id="constituency" disabled required>
                                    <option value="">Select sub-county first</option>
                                </select>
                                <span class="location-help-text">Will populate after sub-county selection</span>
                            </div>
                        </div>

                        <!-- Emergency Contacts (simplified for space) -->
                        <div class="form-field">
                            <span class="field-number">10.</span>
                            <span class="field-label">Emergency Contact:</span>
                        </div>
                        <div class="form-field" style="margin-left: 25px;">
                            <div class="two-column">
                                <div class="field-group">
                                    <span class="field-label">Name</span>
                                    <input type="text" class="field-input" id="emergency1Name" required>
                                </div>
                                <div class="field-group">
                                    <span class="field-label">Relationship</span>
                                    <input type="text" class="field-input" id="emergency1Relationship" required>
                                </div>
                            </div>
                            <div class="field-group" style="margin-top: 10px;">
                                <span class="field-label">Phone Number</span>
                                <input type="tel" class="field-input" id="emergency1Phone" required>
                            </div>
                        </div>

                        <!-- Certification -->
                        <div class="certification">
                            I certify that the information I have provided is correct.
                        </div>

                        <!-- Signature Section -->
                        <div class="signature-section">
                            <div class="signature-field">
                                <div class="signature-line"></div>
                                <span class="signature-label">Signature</span>
                            </div>
                            <div class="signature-field">
                                <div class="signature-line"></div>
                                <span class="signature-label">Date</span>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Navigation for Student Form -->
            <div class="form-navigation">
                <button type="button" class="btn btn-secondary" onclick="clearAllForms()">Clear Form</button>
                <button type="button" class="btn btn-primary" onclick="proceedToMediaForm()" id="nextFormBtn">
                    Next: Media Consent Form →
                </button>
            </div>
        </div>

        <!-- Media Release Form -->
        <div class="form-section" id="mediaFormSection">
            <div class="container">
                <!-- Header Section for Media Form -->
                <div class="header">
                    <div class="header-content">
                        <div class="university-logo">
                            <img src="logo.png" alt="University of Eldoret Logo" width="100" height="100" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 100 100\'%3E%3Ccircle cx=\'50\' cy=\'50\' r=\'45\' fill=\'%232a5298\'/%3E%3Ctext x=\'50\' y=\'55\' text-anchor=\'middle\' fill=\'white\' font-size=\'16\' font-weight=\'bold\'%3EUoE%3C/text%3E%3C/svg%3E'">
                        </div>
                        
                        <div class="header-center">
                            <h1>University of Eldoret</h1>
                            <p class="tagline">Excellence in Innovation and Development</p>
                        </div>
                        
                        <div class="contact-info">
                            <p><strong>UoE/FM/033</strong></p>
                        </div>
                    </div>
                </div>

                <!-- Media Release Form Content -->
                <div class="form-content">
                    <div class="release-form-header">
                        <div class="form-number-box">
                            <span class="form-arrow">▶</span>
                            <span class="form-title-text">RELEASE FORM</span>
                        </div>
                    </div>

                    <form id="mediaConsentForm">
                        <div class="release-content">
                            <p class="release-paragraph">
                                I, <span class="fill-field"><input type="text" class="inline-input" id="mediaFullName" readonly></span> of ID No. <span class="fill-field"><input type="text" class="inline-input" id="mediaIdNumber" readonly></span> hereby 
                                grant consent to the University of <u>Eldoret</u> and its Legal representatives, successors, 
                                assigns, agents and employees the irrevocable and unrestricted right to use and 
                                reproduce photographs and or video images taken of me for the purpose of 
                                publication, promotion advertising or trade, in any manner or medium.
                            </p>

                            <p class="release-paragraph">
                                I agree that the photographs/videos shall thereof constitute sole property of the 
                                University of <u>Eldoret</u> with <u>full right of disposition in any manner whatsoever</u>.
                            </p>

                            <p class="release-paragraph">
                                I hereby release the University it's successors and assigns from any claims 
                                whatsoever in connection with the use, publication of the images/videos thereof.
                            </p>

                            <div class="signature-section media-signature">
                                <div class="signature-row">
                                    <div class="signature-field">
                                        <span class="signature-label">Date</span>
                                        <div class="date-line">
                                            <input type="date" class="signature-date-input" id="mediaDate" readonly>
                                        </div>
                                    </div>
                                </div>

                                <div class="signature-row">
                                    <div class="signature-field">
                                        <span class="signature-label">Signature</span>
                                        <div class="signature-line physical-signature">
                                            <span class="signature-note">(Physical signature required when printing)</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="signature-row">
                                    <div class="signature-field">
                                        <span class="signature-label">Name</span>
                                        <div class="name-line">
                                            <input type="text" class="signature-name-input" id="mediaSignatureName" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Navigation for Media Form -->
            <div class="form-navigation">
                <button type="button" class="btn btn-outline" onclick="goBackToStudentForm()">
                    ← Back to Personal Details
                </button>
                <button type="button" class="btn btn-primary" onclick="submitBothForms()" id="submitBothBtn">
                    Submit Both Forms
                </button>
            </div>
        </div>
    </div>

    <!-- Data Protection Consent Section -->
    <div class="data-protection-section">
        <h3>🔒 Data Protection Consent</h3>
        <div class="consent-container">
            <div class="consent-item">
                <input type="checkbox" id="dataConsent" required>
                <label for="dataConsent">
                    I consent to the University of Eldoret collecting, storing, and processing my personal data provided in these 
                    forms for the purposes of admission, academic administration, and related services. I understand that my data will be 
                    kept securely and only used for the stated purposes in compliance with the Data Protection Act, 2019.
                </label>
            </div>
            <div class="consent-item">
                <input type="checkbox" id="dataRights" required>
                <label for="dataRights">
                    I acknowledge that I have the right to access, correct, or request deletion of my personal data, and to withdraw my 
                    consent at any time by contacting the University through the designated office or email address.
                </label>
            </div>
        </div>
    </div>

    <!-- Final Actions Section -->
    <div class="final-actions" id="finalActions" style="display: none;">
        <div class="completion-message">
            <h3>✅ Registration Complete!</h3>
            <p>Both forms have been submitted successfully. You can now print your forms.</p>
        </div>
        <div class="action-buttons">
            <button type="button" class="btn btn-success" onclick="printBothForms()">
                🖨️ Print Both Forms (4 copies each)
            </button>
            <button type="button" class="btn btn-info" onclick="downloadBothPDFs()">
                📄 Download Both PDFs
            </button>
        </div>
        <div class="print-instructions">
            <h4>📋 Printing Instructions:</h4>
            <ul>
                <li>Print <strong>4 copies</strong> of the Student Personal Details form</li>
                <li>Print <strong>4 copies</strong> of the Media Release form</li>
                <li>Attach passport photos (yellow background) to each copy of the Student form</li>
                <li>Sign each copy of the Media Release form with a physical signature</li>
                <li>Submit all 8 copies to the Registrar Academic office</li>
            </ul>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">Processing...</div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="smooth-flow.js"></script>
</body>
</html>